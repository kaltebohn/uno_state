カードゲーム「UNO」の対戦環境プログラムです。
ゲームの状況を表現するUnoStateクラスと対戦プレイヤを実装しています。
このプログラムを使うことで、自作したUNOの対戦プレイヤを対戦させることができます。
ルールは、[プログラミングコンテスト「ALGORI」](https://www.algori.ntt-east.jp/#/main)を参考にしています。
なお、使用言語はC++です。

# 状態と観測
このリポジトリでは、ゲームの状況を2種類実装しています。
1つはゲームのある時点の完全な状況を保持する「状態(state)」で、
もうひとつは状態のうちあるプレイヤが知ることのできる状況を保持する「観測(observation)」です。

## UnoState
UnoStateは、UNOのある時点におけるゲームの状態を表現するクラスです。

## Observation
UNOでは、各プレイヤは自分以外のプレイヤの手札や山札の内容を知らないことになっています。
そのため、プレイヤにゲームの状況を伝える場合、UnoStateを渡すべきではありません。
そこで、プレイヤにはUnoStateのうち一部の情報のみ保持する構造体を渡すことにします。
Observationは、そうした構造体です。

# 対戦プレイヤ
## Wuerfel
ランダムに行動を決定する対戦プレイヤです。
ただし、UNOではパスをして山札からカードを引けるため、本当にランダムに行動すると
手札が増加し続けてゲームが終わらなくなる場合があります。
そのため、合法手が存在する場合のパスはしません。

## Schlange
ルールベースで行動を決定する対戦プレイヤです。
戦略は以下です。

### チャレンジ

常にしない。

### 色の選択

ワイルドを除き、手札中の一番多い色を選ぶ。

### 引いたカードの提出

合法なら常に提出する。

### カードの提出

- 優先順: 記号カード > 数字カード > シャッフルワイルド = 白いワイルド > ワイルド > ワイルドドロー4 > カードを引く。
- 数字カードは、書いてある数字の大きいものを優先する。
- 優先順位が最高のものが複数あれば、手札に先に追加されたものを出す。

# ディレクトリ
- out: コンパイル結果があります。
- src: ソースファイルがあります。
    - external: 別のリポジトリのソースがあります。
    - test: テスト用のソースがあります。
- .gitignore: Git管理用のファイルです。
- Makefile: コンパイル用のファイルです。

# 実行方法
## コンパイル
ルートディレクトリ上で以下のコマンドを実行してください。足りないパッケージ等は適宜インストールしてください。

```
make
```

## 実行

```
./out/main
```

## ソース改変

プログラムを書き換えた場合、以下で反映できます。

```
make clean && make
```

## テスト

一部ソースのテストを作成しています。利用する場合は以下でコンパイルしてください。
`test/out/`以下にテスト用の実行ファイルが生成されます。

```
make test
```

# 注意
## 白いワイルド
白いワイルドの効果として、ALGORIで定義された「バインド2」を採用した状態を実装しています。
「バインド2」を採用したゲームを実行したい場合、`UnoState`ではなく`UnoStateBind2`を使ってください。
ただし、`UnoStateBind2`に対応する観測クラスを実装していないので、適宜実装する必要があります。
なお、現在、「白いワイルド」は使わないようになっています。
使う場合は、該当箇所のコメントアウトを外してください。

## UNO宣言
UNOでは、残り手札が1枚になる際に「UNO!」と宣言するルールがあります。
しかし、合理的に考えた場合「UNO!」と宣言しないことで得られる利益が存在しないと思われること、
このプログラムは対人ゲームを想定したものではないことから、このプログラムにUNO宣言ルールは含まれていません。

## チャレンジ成功後の挙動
ALGORIでは、チャレンジが成功した後、チャレンジされたプレイヤはワイルドドロー4以外の合法手を提出する必要があります。
しかし、このプログラムではそうした制約は設けていないため、再びワイルドドロー4を提出できます。
